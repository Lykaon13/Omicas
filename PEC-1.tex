% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={PEC 1},
  pdfauthor={JMST},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{PEC 1}
\author{JMST}
\date{2024-10-30}

\begin{document}
\maketitle

\subsection{PEC 1}\label{pec-1}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(httr2)}
\FunctionTok{library}\NormalTok{(GEOquery)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Cargando paquete requerido: Biobase
\end{verbatim}

\begin{verbatim}
## Cargando paquete requerido: BiocGenerics
\end{verbatim}

\begin{verbatim}
## 
## Adjuntando el paquete: 'BiocGenerics'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     IQR, mad, sd, var, xtabs
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     anyDuplicated, aperm, append, as.data.frame, basename, cbind,
##     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
##     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
##     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
##     Position, rank, rbind, Reduce, rownames, sapply, setdiff, table,
##     tapply, union, unique, unsplit, which.max, which.min
\end{verbatim}

\begin{verbatim}
## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with
##     'browseVignettes()'. To cite Bioconductor, see
##     'citation("Biobase")', and for packages 'citation("pkgname")'.
\end{verbatim}

\begin{verbatim}
## Setting options('download.file.method.GEOquery'='auto')
\end{verbatim}

\begin{verbatim}
## Setting options('GEOquery.inmemory.gpl'=FALSE)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readxl)}
\FunctionTok{library}\NormalTok{(SummarizedExperiment)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Cargando paquete requerido: MatrixGenerics
\end{verbatim}

\begin{verbatim}
## Cargando paquete requerido: matrixStats
\end{verbatim}

\begin{verbatim}
## 
## Adjuntando el paquete: 'matrixStats'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:Biobase':
## 
##     anyMissing, rowMedians
\end{verbatim}

\begin{verbatim}
## 
## Adjuntando el paquete: 'MatrixGenerics'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:matrixStats':
## 
##     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
##     colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
##     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
##     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
##     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
##     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
##     colWeightedMeans, colWeightedMedians, colWeightedSds,
##     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
##     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
##     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
##     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
##     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
##     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
##     rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
##     rowWeightedSds, rowWeightedVars
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:Biobase':
## 
##     rowMedians
\end{verbatim}

\begin{verbatim}
## Cargando paquete requerido: GenomicRanges
\end{verbatim}

\begin{verbatim}
## Cargando paquete requerido: stats4
\end{verbatim}

\begin{verbatim}
## Cargando paquete requerido: S4Vectors
\end{verbatim}

\begin{verbatim}
## 
## Adjuntando el paquete: 'S4Vectors'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:utils':
## 
##     findMatches
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     expand.grid, I, unname
\end{verbatim}

\begin{verbatim}
## Cargando paquete requerido: IRanges
\end{verbatim}

\begin{verbatim}
## 
## Adjuntando el paquete: 'IRanges'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:grDevices':
## 
##     windows
\end{verbatim}

\begin{verbatim}
## Cargando paquete requerido: GenomeInfoDb
\end{verbatim}

\subsection{1. Archivo}\label{archivo}

Para este ejercicio vamos a utilizar los datos del github que se nos
proporciona, en concreto el estudio ``NMR data from a gastric cancer
study used in a metabolomics data analysis tutorial''. Nos descargamos
el archivo en excel con los datos a una carpeta incluida en el proyecto
y lo pasamos a una variable.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Cargamos el archivo csv}
\NormalTok{temp\_file }\OtherTok{\textless{}{-}} \StringTok{"datos/GastricCancer\_NMR.xlsx"}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(temp\_file)}
\FunctionTok{colnames}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] "Idx"        "SampleID"   "SampleType" "Class"      "M1"        
##   [6] "M2"         "M3"         "M4"         "M5"         "M6"        
##  [11] "M7"         "M8"         "M9"         "M10"        "M11"       
##  [16] "M12"        "M13"        "M14"        "M15"        "M16"       
##  [21] "M17"        "M18"        "M19"        "M20"        "M21"       
##  [26] "M22"        "M23"        "M24"        "M25"        "M26"       
##  [31] "M27"        "M28"        "M29"        "M30"        "M31"       
##  [36] "M32"        "M33"        "M34"        "M35"        "M36"       
##  [41] "M37"        "M38"        "M39"        "M40"        "M41"       
##  [46] "M42"        "M43"        "M44"        "M45"        "M46"       
##  [51] "M47"        "M48"        "M49"        "M50"        "M51"       
##  [56] "M52"        "M53"        "M54"        "M55"        "M56"       
##  [61] "M57"        "M58"        "M59"        "M60"        "M61"       
##  [66] "M62"        "M63"        "M64"        "M65"        "M66"       
##  [71] "M67"        "M68"        "M69"        "M70"        "M71"       
##  [76] "M72"        "M73"        "M74"        "M75"        "M76"       
##  [81] "M77"        "M78"        "M79"        "M80"        "M81"       
##  [86] "M82"        "M83"        "M84"        "M85"        "M86"       
##  [91] "M87"        "M88"        "M89"        "M90"        "M91"       
##  [96] "M92"        "M93"        "M94"        "M95"        "M96"       
## [101] "M97"        "M98"        "M99"        "M100"       "M101"      
## [106] "M102"       "M103"       "M104"       "M105"       "M106"      
## [111] "M107"       "M108"       "M109"       "M110"       "M111"      
## [116] "M112"       "M113"       "M114"       "M115"       "M116"      
## [121] "M117"       "M118"       "M119"       "M120"       "M121"      
## [126] "M122"       "M123"       "M124"       "M125"       "M126"      
## [131] "M127"       "M128"       "M129"       "M130"       "M131"      
## [136] "M132"       "M133"       "M134"       "M135"       "M136"      
## [141] "M137"       "M138"       "M139"       "M140"       "M141"      
## [146] "M142"       "M143"       "M144"       "M145"       "M146"      
## [151] "M147"       "M148"       "M149"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 153
##     Idx SampleID SampleType Class    M1      M2    M3    M4    M5    M6    M7
##   <dbl> <chr>    <chr>      <chr> <dbl>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
## 1     1 sample_1 QC         QC     90.1   492.  203.   35   164.   19.7  41  
## 2     2 sample_2 Sample     GC     43     526.  130.   NA   694.  114.   37.9
## 3     3 sample_3 Sample     BN    214.  10703.  105.   46.8 483.  152.  110. 
## 4     4 sample_4 Sample     HE     31.6    59.7  86.4  14    88.6  10.3 170. 
## 5     5 sample_5 Sample     GC     81.9   259.  315.    8.7 243.   18.4 349. 
## 6     6 sample_6 Sample     BN    197.    128.  862.   18.7 200.    4.7  37.3
## # i 142 more variables: M8 <dbl>, M9 <dbl>, M10 <dbl>, M11 <dbl>, M12 <dbl>,
## #   M13 <dbl>, M14 <dbl>, M15 <dbl>, M16 <dbl>, M17 <dbl>, M18 <dbl>,
## #   M19 <dbl>, M20 <dbl>, M21 <dbl>, M22 <dbl>, M23 <dbl>, M24 <dbl>,
## #   M25 <dbl>, M26 <dbl>, M27 <dbl>, M28 <dbl>, M29 <dbl>, M30 <dbl>,
## #   M31 <dbl>, M32 <dbl>, M33 <dbl>, M34 <dbl>, M35 <dbl>, M36 <dbl>,
## #   M37 <dbl>, M38 <dbl>, M39 <dbl>, M40 <dbl>, M41 <dbl>, M42 <dbl>,
## #   M43 <dbl>, M44 <dbl>, M45 <dbl>, M46 <dbl>, M47 <dbl>, M48 <dbl>, ...
\end{verbatim}

\subsection{2. Datos}\label{datos}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#preparamos estos datos como un dataframe}
\CommentTok{\#Las dos primeras columnas se excluyen porque son el ID del metabolito y las otras dos son el tipo de muestra y la clase}
\NormalTok{expression\_data }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(data[, }\SpecialCharTok{{-}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{)])  }

\CommentTok{\#Creamos metadatos para los metabolitos (filas)}
\NormalTok{metadatos\_filas }\OtherTok{\textless{}{-}} \FunctionTok{DataFrame}\NormalTok{(}\AttributeTok{metabolite\_id =}\NormalTok{ data[[}\DecValTok{1}\NormalTok{]])}

\CommentTok{\#Creamos metadatos para las muestras (columnas)}
\NormalTok{sample\_ids }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(expression\_data)}
\NormalTok{metadatos\_columnas }\OtherTok{\textless{}{-}} \FunctionTok{DataFrame}\NormalTok{(}\AttributeTok{sample\_id =}\NormalTok{ sample\_ids)}

\CommentTok{\#Hacemos el objeto summarizedExperiment}
\NormalTok{se }\OtherTok{\textless{}{-}} \FunctionTok{SummarizedExperiment}\NormalTok{(}
    \AttributeTok{assays =} \FunctionTok{list}\NormalTok{(}\AttributeTok{counts =}\NormalTok{ expression\_data),}
    \AttributeTok{rowData =}\NormalTok{ metadatos\_filas,}
    \AttributeTok{colData =}\NormalTok{ metadatos\_columnas}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Exploración del dataset
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Vemos las caracteristicas del objeto }
\NormalTok{se}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## class: SummarizedExperiment 
## dim: 140 149 
## metadata(0):
## assays(1): counts
## rownames: NULL
## rowData names(1): metabolite_id
## colnames(149): M1 M2 ... M148 M149
## colData names(1): sample_id
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#podemos ver los primeros datos}
\FunctionTok{head}\NormalTok{(}\FunctionTok{assay}\NormalTok{(se))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         M1      M2    M3   M4    M5    M6    M7    M8    M9   M10    M11   M12
## [1,]  90.1   491.6 202.9 35.0 164.2  19.7  41.0  46.5  17.3 106.8   61.7  75.3
## [2,]  43.0   525.7 130.2   NA 694.5 114.5  37.9 125.7  57.8    NA  490.6 203.4
## [3,] 214.3 10703.2 104.7 46.8 483.4 152.3 110.1  85.1 238.3  48.0 2441.2 100.0
## [4,]  31.6    59.7  86.4 14.0  88.6  10.3 170.3  23.9    NA    NA  140.7  12.6
## [5,]  81.9   258.7 315.1  8.7 243.2  18.4 349.4  61.1  12.2  72.9   48.7  57.3
## [6,] 196.9   128.2 862.5 18.7 200.1   4.7  37.3 243.7 293.3 113.1  103.7 116.6
##        M13  M14   M15   M16  M17   M18   M19   M20   M21   M22   M23   M24  M25
## [1,]  79.7 35.3  28.8 245.9  5.8 122.2  90.9  47.0  49.0  37.2 422.0 155.1 21.4
## [2,] 330.8   NA 210.7 150.3 71.5 553.1 217.7 207.9 238.8 297.2 591.2 446.4 28.3
## [3,] 873.3 29.3  45.4 226.4 36.3 371.9  98.1 116.5  30.3  24.6 593.4 232.6 35.1
## [4,]  46.3 62.9  38.3  49.7  0.4  31.3  38.6  53.2  45.4   3.7 130.1   1.6 26.6
## [5,] 140.1 77.8  51.0  71.3 18.8 265.0  84.7  78.8 141.3  58.0 722.1 174.7 58.9
## [6,]  81.7 52.3  76.8 273.5 45.8 394.7  66.9  63.0 101.1  96.6 640.5  74.8 29.1
##       M26   M27    M28   M29  M30    M31   M32   M33   M34    M35   M36   M37
## [1,] 16.5    NA   19.9  65.0 22.0   18.9  97.8 274.1  26.3  110.8  13.0  33.7
## [2,] 47.9 126.8   12.9 291.9 58.5 1336.6 621.2 776.7 324.5  282.8 154.3 403.3
## [3,] 26.8  78.4 3772.3 144.3 52.8    0.2 360.1 532.3 507.0 3207.5 161.7  21.7
## [4,] 10.3  22.8   14.5  25.5 11.2    4.8 111.6 133.4  37.3     NA  34.5  31.0
## [5,] 65.9   2.8   15.3  63.5 38.1   11.2 233.6 328.4  79.4    7.1 305.9  12.2
## [6,] 20.3 185.5   55.9 157.6 88.8  112.0  76.4 297.9    NA     NA  17.4 141.4
##        M38   M39   M40  M41   M42  M43   M44    M45   M46   M47     M48   M49
## [1,] 352.3  34.7  33.8 69.9  47.7  7.9 119.1  631.6 403.7  47.4  8029.5  91.3
## [2,]  11.7  66.1  50.9   NA 226.8 46.2  45.4 5354.5 109.3    NA 16744.8 775.4
## [3,] 947.7 185.6 124.3 80.0 129.5 40.9  79.4 1230.8 382.8    NA 12939.2 464.5
## [4,]  60.5  14.7  28.8 80.1  67.0 11.0  34.8 1679.3   9.7  38.6  4562.6 112.2
## [5,] 327.2  23.3  87.3 84.7 116.2 40.7  38.4 2035.5 278.7  99.2 12562.3 390.7
## [6,] 362.5  52.9 100.6   NA 110.9 19.3   9.2 2578.0   7.0 223.6  8484.2 107.0
##        M50   M51   M52    M53  M54     M55   M56    M57    M58    M59    M60
## [1,]  98.1 372.1 148.2  562.4  0.3   102.6  74.1  200.4  195.6  474.5  170.9
## [2,] 563.5 520.6 306.7 1292.2  4.6   604.3 140.3 1158.9 1631.4  590.9  798.6
## [3,] 512.4    NA 197.6 6413.9 26.7    19.7 145.8 9435.5 1155.3 6537.7 2813.2
## [4,]  67.6 263.2 134.8  130.6  1.0    36.2  44.7  141.6  159.8   74.6   38.7
## [5,] 197.8 575.6 190.7  759.9  2.3    70.4 148.6  612.1  490.4  619.4  390.7
## [6,] 128.8 229.6  90.3  689.4  0.4 12202.2 116.8  864.8 1120.2  513.3   25.0
##         M61   M62     M63   M64    M65    M66   M67   M68   M69   M70   M71
## [1,]  564.9 232.0   253.1 115.9  262.7 3104.5  94.5 128.9   0.6  13.8  23.8
## [2,] 1215.6 785.6  2965.9 490.2 1416.5 3168.2 601.0 257.4 288.0  68.0 232.6
## [3,] 3118.4    NA 12076.8 612.3 1798.1  689.4 531.3 125.0 112.7 194.8  51.5
## [4,]  264.4 195.5   511.6 309.8  156.9  632.1  55.2 264.9  29.9  14.0  16.2
## [5,] 1036.3 442.1   824.3 580.5  662.8  507.3 121.4 232.4  73.3  42.3  32.9
## [6,] 1148.6 512.5   731.5 169.5 1148.2  933.1 163.6 112.7 220.5  47.0  28.1
##        M72   M73  M74   M75    M76    M77  M78   M79    M80    M81   M82    M83
## [1,] 169.9 134.3  9.9  75.7  606.9  451.5  0.1  20.2  455.8  314.0    NA     NA
## [2,] 427.9 260.0 88.2 408.1 1127.2  799.1 46.0 199.6  205.4 1399.8 121.7 8707.8
## [3,] 243.4 214.0 46.2 395.6 2940.8 1532.2   NA    NA  204.9 2942.9 147.8     NA
## [4,]    NA  18.6  9.2 100.1   73.0     NA  1.6    NA  141.6  304.2   0.3  198.4
## [5,] 250.4  79.2 20.0 503.2  708.4  774.8   NA    NA  251.0  425.9  38.5  213.5
## [6,] 274.3 131.2  1.6 196.3  512.5  308.2 40.7  28.5 2023.8  929.3 133.8  363.7
##        M84   M85   M86  M87   M88    M89   M90   M91  M92   M93    M94  M95
## [1,]   8.8  35.2  40.2 16.8 136.3  384.5  28.6  60.0 10.1  69.8   99.3 13.8
## [2,] 108.4 125.5 162.0 28.3 319.6 3712.3 285.6 337.5 84.3 120.4 2383.3 97.2
## [3,]  18.7  85.8  91.4 99.3 396.0  694.1 277.9  61.3   NA 236.4  579.0   NA
## [4,]  67.7   0.7  54.1 19.2  75.2  180.5  26.3  26.2 12.1  50.7  119.6   NA
## [5,]  30.2   5.8 695.7 23.7 216.2  485.6  75.8  65.2 20.4 111.9  569.7 36.8
## [6,] 484.3  33.3  79.0 11.8 208.2 1139.8  56.1  79.8 18.5  38.0 1233.6   NA
##       M96  M97  M98  M99   M100  M101  M102   M103  M104  M105  M106   M107
## [1,]   NA 19.4 10.2 30.6  108.4  31.0 168.1  182.5 185.3  44.0  30.8  214.2
## [2,]  7.6   NA 42.1 46.1 1348.1 148.7  58.6 1482.8 333.6 193.5  71.0  834.3
## [3,] 11.7 12.9 78.1 75.3  206.9  42.3 189.3  211.5 367.8 147.5    NA 1338.7
## [4,]  6.7  6.5 20.1 17.1  124.9  21.4  53.9   50.3 105.8  31.8  43.1  160.1
## [5,]  2.5 14.4 15.8 51.2  359.8  28.2 164.0  167.1 502.1 419.6  33.9  393.1
## [6,] 12.5 11.9 70.3 40.6  240.0  15.9 213.0  459.2 269.3 142.6 118.8  274.3
##       M108   M109  M110   M111  M112   M113  M114  M115  M116  M117  M118  M119
## [1,]   8.4  239.0 156.8    6.6 201.7   84.6  70.2 291.2  32.9 112.3 198.7 128.5
## [2,] 157.5  113.8  69.3  150.6 477.6    3.3 217.9  66.6 131.0 694.5 635.3 209.7
## [3,] 244.7 1045.7  83.2 2664.3 550.5 1319.4 413.9  55.5  42.5  25.7 271.9  88.9
## [4,]  41.9   16.6  31.6   22.4  18.8   90.7  39.6 136.2  11.7  91.1  59.1  16.1
## [5,]  52.8   26.3  47.5   78.2 538.8  133.3  65.1 411.1  48.9  18.8 225.8  91.5
## [6,]  48.1  635.2 124.6   32.4 402.4     NA 230.4 163.7  13.1 890.0 587.1 241.5
##       M120 M121 M122  M123  M124  M125  M126  M127   M128   M129  M130   M131
## [1,] 109.4  3.7 18.5 266.1 431.2 145.1  35.7    NA   48.9 2445.7  37.9 1258.4
## [2,] 237.9 47.4 41.8 188.3 673.1 283.1  61.7 367.0  225.9  961.8 100.1 1636.7
## [3,] 105.4 40.4 39.0  67.6 997.8 180.6  76.2 145.4  494.4  673.4  42.8 1954.2
## [4,]    NA   NA 12.3  50.1 184.1 102.1  31.1   0.7  649.8  651.7  31.3  799.8
## [5,]  42.9 40.3  3.9 235.0 585.5 624.2 122.4   0.1  726.1 2048.9    NA 2380.8
## [6,]  69.1  0.6 14.3  36.3 848.7 135.0  38.9 375.8 1392.6  850.6  75.9  964.9
##       M132  M133   M134    M135   M136   M137   M138   M139  M140   M141 M142
## [1,] 168.5  32.7  706.9  1106.9  107.6 2807.8  481.0   68.4 115.1   64.8 25.5
## [2,] 206.6 148.5 6674.1  9079.2     NA  938.9 6084.5   75.3  84.2  357.1 16.1
## [3,] 193.6 129.8  787.2  1404.5 1564.3 1163.2  246.0 2460.4 993.5 1698.5 32.9
## [4,]  34.0  22.1  392.4   550.0   43.4  370.6  109.3   68.7  58.1   83.5 60.5
## [5,] 168.9  58.5  973.9  1494.7   85.8  984.0 1037.4   66.4  44.5   47.6 45.6
## [6,] 102.5  76.5     NA 19079.6  741.4 2916.5 1732.1  381.9 143.8  157.2 10.4
##        M143 M144  M145  M146  M147  M148  M149
## [1,]  473.9 26.5    NA   6.8 118.6 710.6 203.6
## [2,]  455.5 29.5  28.1  35.8 316.1 390.7 199.0
## [3,]   75.9 33.2 802.8 967.6 154.4  31.6 195.2
## [4,]  136.9 17.0  10.2  24.7  64.1  91.4  91.6
## [5,] 1441.7 35.2   0.1  22.8 135.0 322.3 254.3
## [6,]  182.1 32.6 435.1 325.3 162.4 129.7 207.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#los nombres de las muestras}
\FunctionTok{colData}\NormalTok{(se)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## DataFrame with 149 rows and 1 column
##        sample_id
##      <character>
## M1            M1
## M2            M2
## M3            M3
## M4            M4
## M5            M5
## ...          ...
## M145        M145
## M146        M146
## M147        M147
## M148        M148
## M149        M149
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Los id de las muestras}
\FunctionTok{rowData}\NormalTok{(se)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## DataFrame with 140 rows and 1 column
##     metabolite_id
##         <numeric>
## 1               1
## 2               2
## 3               3
## 4               4
## 5               5
## ...           ...
## 136           136
## 137           137
## 138           138
## 139           139
## 140           140
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#separamos la matriz principal}
\NormalTok{data\_counts }\OtherTok{\textless{}{-}} \FunctionTok{assay}\NormalTok{(se)}

\CommentTok{\#calculamos estadísticas descriptivas para los metabolitos}
\NormalTok{metabolite\_means }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(data\_counts, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{metabolite\_sds }\OtherTok{\textless{}{-}} \FunctionTok{rowSds}\NormalTok{(data\_counts, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{metabolite\_medians }\OtherTok{\textless{}{-}} \FunctionTok{rowMedians}\NormalTok{(data\_counts, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Hacemos el resumen básico}
\FunctionTok{summary}\NormalTok{(metabolite\_means)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    48.6   241.9   288.0   386.9   472.9  1522.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(metabolite\_sds)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   131.9   715.8   877.2  1251.1  1444.4 13634.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(metabolite\_medians)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   13.60   64.70   91.97  105.44  134.10  376.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#realizamos un gráfico en caja para ver valóres atípicos de la muestra}
\FunctionTok{boxplot}\NormalTok{(data\_counts, }\AttributeTok{main =} \StringTok{"Distribución de Intensidades de Metabolitos en Muestras"}\NormalTok{, }\AttributeTok{las =} \DecValTok{2}\NormalTok{,}
        \AttributeTok{xlab =} \StringTok{"Muestras"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Intensidad"}\NormalTok{, }\AttributeTok{col =} \StringTok{"lightblue"}\NormalTok{, }\AttributeTok{outline =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{PEC-1_files/figure-latex/graficos-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Un histograma de intensidades para ver su distribución}
\FunctionTok{hist}\NormalTok{(data\_counts, }\AttributeTok{main =} \StringTok{"Distribución de Intensidades de Metabolitos"}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{"Intensidad"}\NormalTok{, }\AttributeTok{col =} \StringTok{"lightgreen"}\NormalTok{, }\AttributeTok{breaks =} \DecValTok{30}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{PEC-1_files/figure-latex/graficos-2.pdf}

\subsection{Enlaces}\label{enlaces}

Todo el proyecto se encuentra subido a la siguiente dirección de GitHub:

\end{document}
